{"ast":null,"code":"import { mapState } from \"vuex\";\nimport GeneralButton from \"@/components/GeneralButton.vue\";\nexport default {\n  data() {\n    return {\n      identite: \"guest\",\n      groupe: \"GUEST\",\n      disableButton: true\n    };\n  },\n  components: {\n    GeneralButton\n  },\n  computed: {\n    ...mapState([\"produits\", \"cartItems\", \"favorites\", \"actualProducts\"]),\n    currentProduct() {\n      const productId = this.$route.params.id;\n      return this.actualProducts[productId];\n    }\n  },\n  methods: {\n    isInCart(item) {\n      return this.cartItems.find(cartItem => cartItem.id === item.id) !== undefined;\n    },\n    addOrRemove(product) {\n      const isInCart = this.isInCart(product);\n      const mutationType = isInCart ? \"REMOVE_FROM_CART\" : \"ADD_TO_CART\";\n      product.quantity = product.moq;\n      this.$store.commit(mutationType, product);\n    },\n    loadCart() {\n      const storedCartItems = localStorage.getItem(\"cartItems\");\n      if (storedCartItems) {\n        this.$store.commit(\"SET_CART_ITEMS\", JSON.parse(storedCartItems));\n      }\n    },\n    isFavorite(product) {\n      return this.favorites.some(fav => fav.id === product.id);\n    },\n    toggleFavorite(product) {\n      if (this.groupe !== \"USER\") {\n        alert(\"Vous devez être membre pour pouvoir créer des favoris.\");\n      } else {\n        const index = this.favorites.findIndex(fav => fav.id === product.id);\n        if (index === -1) {\n          // If the product is not in favorites, add it\n          this.$store.commit(\"ADD_TO_FAVORITES\", product);\n        } else {\n          // If the product is in favorites, remove it\n          this.$store.commit(\"REMOVE_FROM_FAVORITES\", product);\n        }\n        this.saveFavorites();\n      }\n    },\n    saveFavorites() {\n      localStorage.setItem(\"favorites\", JSON.stringify(this.favorites));\n      console.log(\"Saved Favorites:\", this.favorites);\n    },\n    loadFavorites() {\n      const storedFavorites = localStorage.getItem(\"favorites\");\n      if (storedFavorites) {\n        this.$store.commit(\"SET_FAVORITES\", JSON.parse(storedFavorites));\n      }\n    }\n  },\n  created() {\n    let identity = localStorage.getItem(\"myIdentity\");\n    if (identity) {\n      this.identite = JSON.parse(localStorage.getItem(\"myIdentity\")).raisonSociale;\n      this.$store.commit(\"CHANGE_IDENTITY\", this.identite);\n      this.groupe = JSON.parse(localStorage.getItem(\"myIdentity\")).role;\n      this.loadFavorites();\n      this.loadCart();\n    }\n    const storedActualProducts = JSON.parse(localStorage.getItem(\"actualProducts\"));\n    if (storedActualProducts) {\n      this.$store.commit(\"SET_ACTUAL_PRODUCTS\", storedActualProducts);\n    } else {\n      this.$store.commit(\"SET_ACTUAL_PRODUCTS\", [...this.$store.state.produits]);\n    }\n  }\n};","map":{"version":3,"names":["mapState","GeneralButton","data","identite","groupe","disableButton","components","computed","currentProduct","productId","$route","params","id","actualProducts","methods","isInCart","item","cartItems","find","cartItem","undefined","addOrRemove","product","mutationType","quantity","moq","$store","commit","loadCart","storedCartItems","localStorage","getItem","JSON","parse","isFavorite","favorites","some","fav","toggleFavorite","alert","index","findIndex","saveFavorites","setItem","stringify","console","log","loadFavorites","storedFavorites","created","identity","raisonSociale","role","storedActualProducts","state","produits"],"sources":["/workspaces/Projet-WebWares/src/views/ProductDetails.vue"],"sourcesContent":["<template>\r\n  <div class=\"product-details-container\">\r\n    <div class=\"svg\">\r\n      <svg\r\n        v-if=\"!isFavorite(currentProduct) || groupe != 'USER'\"\r\n        @click=\"toggleFavorite(currentProduct)\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"16\"\r\n        height=\"16\"\r\n        fill=\"currentColor\"\r\n        class=\"bi bi-heart\"\r\n        viewBox=\"0 0 16 16\"\r\n      >\r\n        <path\r\n          d=\"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15\"\r\n        />\r\n      </svg>\r\n      <svg\r\n        v-else\r\n        @click=\"toggleFavorite(currentProduct)\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"16\"\r\n        height=\"16\"\r\n        fill=\"currentColor\"\r\n        class=\"bi bi-heart-fill\"\r\n        viewBox=\"0 0 16 16\"\r\n      >\r\n        <path\r\n          fill-rule=\"evenodd\"\r\n          d=\"M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314\"\r\n        />\r\n      </svg>\r\n      <img :src=\"currentProduct.image\" :alt=\"currentProduct.image\" />\r\n    </div>\r\n    <div class=\"prod-description-container\">\r\n      <h2>{{ currentProduct.titre }}</h2>\r\n      <p>{{ currentProduct.description }}</p>\r\n      <br />\r\n      <p v-if=\"groupe !== 'GUEST'\">{{ currentProduct.prix }} €</p>\r\n      <p class=\"moq-text\">\r\n        Quantité minimum de commande : {{ currentProduct.moq }}\r\n      </p>\r\n      <div v-if=\"groupe !== 'USER'\">\r\n        <GeneralButton\r\n          label=\"Ajouter au panier\"\r\n          @generalEvent=\"addOrRemove(currentProduct)\"\r\n          :disabled=\"disableButton\"\r\n          class=\"disabledButton\"\r\n          title=\"Cette fonctionnalité n'est disponible que pour nos membres.\"\r\n        />\r\n        <p v-if=\"identite === 'guest'\" class=\"guestMessage\">\r\n          Vous devez être membre pour pouvoir commander.\r\n        </p>\r\n      </div>\r\n      <div v-else>\r\n        <GeneralButton\r\n          v-if=\"!isInCart(currentProduct)\"\r\n          label=\"Ajouter au panier\"\r\n          @generalEvent=\"addOrRemove(currentProduct)\"\r\n        />\r\n\r\n        <GeneralButton\r\n          v-else\r\n          label=\"Retirer du panier\"\r\n          @generalEvent=\"addOrRemove(currentProduct)\"\r\n          class=\"removeFromCartBtn\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport GeneralButton from \"@/components/GeneralButton.vue\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      identite: \"guest\",\r\n      groupe: \"GUEST\",\r\n      disableButton: true,\r\n    };\r\n  },\r\n\r\n  components: {\r\n    GeneralButton,\r\n  },\r\n\r\n  computed: {\r\n    ...mapState([\"produits\", \"cartItems\", \"favorites\", \"actualProducts\"]),\r\n    currentProduct() {\r\n      const productId = this.$route.params.id;\r\n      return this.actualProducts[productId];\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    isInCart(item) {\r\n      return (\r\n        this.cartItems.find((cartItem) => cartItem.id === item.id) !== undefined\r\n      );\r\n    },\r\n\r\n    addOrRemove(product) {\r\n      const isInCart = this.isInCart(product);\r\n      const mutationType = isInCart ? \"REMOVE_FROM_CART\" : \"ADD_TO_CART\";\r\n      product.quantity = product.moq;\r\n      this.$store.commit(mutationType, product);\r\n    },\r\n\r\n    loadCart() {\r\n      const storedCartItems = localStorage.getItem(\"cartItems\");\r\n      if (storedCartItems) {\r\n        this.$store.commit(\"SET_CART_ITEMS\", JSON.parse(storedCartItems));\r\n      }\r\n    },\r\n\r\n    isFavorite(product) {\r\n      return this.favorites.some((fav) => fav.id === product.id);\r\n    },\r\n\r\n    toggleFavorite(product) {\r\n      if (this.groupe !== \"USER\") {\r\n        alert(\"Vous devez être membre pour pouvoir créer des favoris.\");\r\n      } else {\r\n        const index = this.favorites.findIndex((fav) => fav.id === product.id);\r\n\r\n        if (index === -1) {\r\n          // If the product is not in favorites, add it\r\n          this.$store.commit(\"ADD_TO_FAVORITES\", product);\r\n        } else {\r\n          // If the product is in favorites, remove it\r\n          this.$store.commit(\"REMOVE_FROM_FAVORITES\", product);\r\n        }\r\n\r\n        this.saveFavorites();\r\n      }\r\n    },\r\n\r\n    saveFavorites() {\r\n      localStorage.setItem(\"favorites\", JSON.stringify(this.favorites));\r\n      console.log(\"Saved Favorites:\", this.favorites);\r\n    },\r\n\r\n    loadFavorites() {\r\n      const storedFavorites = localStorage.getItem(\"favorites\");\r\n      if (storedFavorites) {\r\n        this.$store.commit(\"SET_FAVORITES\", JSON.parse(storedFavorites));\r\n      }\r\n    },\r\n  },\r\n\r\n  created() {\r\n    let identity = localStorage.getItem(\"myIdentity\");\r\n    if (identity) {\r\n      this.identite = JSON.parse(\r\n        localStorage.getItem(\"myIdentity\")\r\n      ).raisonSociale;\r\n\r\n      this.$store.commit(\"CHANGE_IDENTITY\", this.identite);\r\n\r\n      this.groupe = JSON.parse(localStorage.getItem(\"myIdentity\")).role;\r\n\r\n      this.loadFavorites();\r\n\r\n      this.loadCart();\r\n    }\r\n\r\n    const storedActualProducts = JSON.parse(\r\n      localStorage.getItem(\"actualProducts\")\r\n    );\r\n    if (storedActualProducts) {\r\n      this.$store.commit(\"SET_ACTUAL_PRODUCTS\", storedActualProducts);\r\n    } else {\r\n      this.$store.commit(\"SET_ACTUAL_PRODUCTS\", [\r\n        ...this.$store.state.produits,\r\n      ]);\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.product-details-container {\r\n  display: flex;\r\n  margin: 50px auto;\r\n  align-items: center;\r\n  width: 700px;\r\n  position: relative;\r\n}\r\n\r\n.svg {\r\n  position: relative;\r\n}\r\n\r\n.bi-heart,\r\n.bi-heart-fill {\r\n  color: rgb(231, 67, 39);\r\n  position: absolute;\r\n  top: 35px;\r\n  right: 35px;\r\n  position: absolute;\r\n}\r\n\r\n.product-details-container img {\r\n  width: auto;\r\n  height: 300px;\r\n  margin: 20px;\r\n}\r\n\r\n.prod-description-container {\r\n  text-align: left;\r\n  margin: 20px;\r\n}\r\n\r\n.moq-text {\r\n  font-style: italic;\r\n}\r\n\r\n.removeFromCartBtn {\r\n  background-color: rgb(94, 25, 111);\r\n}\r\n\r\n.disabledButton {\r\n  background-color: #ccc;\r\n  color: #555;\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n\r\n.guestMessage {\r\n  font-size: 0.8em;\r\n  font-style: italic;\r\n  color: rgb(231, 67, 39);\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}